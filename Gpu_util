{ "annotations": { "list": [ { "builtIn": 1, "datasource": "-- Grafana --", "enable": true, "hide": true, "iconColor": "#000000", "name": "Annotations & Alerts", "type": "dashboard" } ] }, "editable": true, "gnetId": null, "graphTooltip": 0, "id": null, "links": [], "panels": [ { "type": "row", "title": "Per-host GPU overview", "gridPos": { "h": 1, "w": 24, "x": 0, "y": 0 }, "collapsed": false }, { "type": "timeseries", "title": "GPU SM Utilization (per GPU) - $node", "datasource": "${DS_PROMETHEUS}", "targets": [ { "expr": "avg by(gpu) (dcgm_gpu_sm_utilization{instance="$node"}) / 1024 / 1024", "legendFormat": "GPU {{gpu}}", "refId": "B" } ], "gridPos": { "h": 8, "w": 12, "x": 12, "y": 1 } }, { "type": "heatmap", "title": "GPU SM Utilization Heatmap (cluster)", "datasource": "${DS_PROMETHEUS}", "targets": [ { "expr": "dcgm_gpu_sm_utilization", "refId": "C", "format": "time_series" } ], "gridPos": { "h": 8, "w": 24, "x": 0, "y": 9 } }, { "type": "table", "title": "Top N GPUs by Memory Used (MB)", "datasource": "${DS_PROMETHEUS}", "targets": [ { "expr": "topk(10, dcgm_gpu_memory_used_bytes)", "format": "table", "instant": true, "refId": "D" } ], "options": { "showHeader": true }, "transform": "timeseries_aggregations", "gridPos": { "h": 6, "w": 12, "x": 0, "y": 17 } }, { "type": "table", "title": "Top GPU Processes (by GPU memory)", "datasource": "${DS_PROMETHEUS}", "targets": [ { "expr": "topk(20, dcgm_process_used_gpu_memory)", "format": "table", "instant": true, "refId": "E" } ], "options": { "showHeader": true }, "fieldConfig": { "defaults": { "unit": "megabytes" } }, "gridPos": { "h": 6, "w": 12, "x": 12, "y": 17 } }, { "type": "table", "title": "Per-Process GPU Utilization (SM & Memory)", "datasource": "${DS_PROMETHEUS}", "targets": [ { "expr": "dcgm_process_utilization_sm", "legendFormat": "sm {{pid}} {{process_name}}", "refId": "F" }, { "expr": "dcgm_process_used_gpu_memory", "legendFormat": "mem {{pid}} {{process_name}}", "refId": "G" } ], "gridPos": { "h": 8, "w": 24, "x": 0, "y": 23 } } ], "refresh": "10s", "schemaVersion": 36, "style": "dark", "tags": ["gpu", "dcgm", "nvidia", "prometheus"], "templating": { "list": [ { "type": "datasource", "name": "DS_PROMETHEUS", "query": "prometheus", "refresh": 2 }, { "name": "node", "type": "query", "label": "Node (instance)", "datasource": "${DS_PROMETHEUS}", "query": "label_values(dcgm_gpu_sm_utilization, instance)", "multi": true, "includeAll": true, "allValue": ".", "refresh": 2 }, { "name": "gpu", "type": "query", "label": "GPU", "datasource": "${DS_PROMETHEUS}", "query": "label_values(dcgm_gpu_sm_utilization, gpu)", "multi": true, "includeAll": true, "allValue": ".", "refresh": 2 }, { "name": "namespace", "type": "query", "label": "Kubernetes Namespace", "datasource": "${DS_PROMETHEUS}", "query": "label_values(kube_pod_info, namespace)", "multi": true, "includeAll": true, "allValue": ".*", "refresh": 2 } ] }, "time": { "from": "now-1h", "to": "now" }, "timepicker": {}, "timezone": "browser", "title": "GPU per-process and per-GPU - DCGM / Prometheus", "version": 1 }
